{"version":3,"file":"index.js","names":["_cucumber","require","_reporter","_runtime","_legacy","_runtime2","_utils","BeforeAll","setGlobalTestRuntime","AllureCucumberTestRuntime","Before","name","scenario","testPlan","parseTestPlan","pickle","posixPath","getPosixPathRelativeToProjectRoot","fullName","concat","tags","map","tag","includedInTestPlan","world","attach","Buffer","from"],"sources":["../../src/index.ts"],"sourcesContent":["import { Before, BeforeAll, world } from \"@cucumber/cucumber\";\nimport { includedInTestPlan } from \"allure-js-commons/sdk/reporter\";\nimport { parseTestPlan } from \"allure-js-commons/sdk/reporter\";\nimport { setGlobalTestRuntime } from \"allure-js-commons/sdk/runtime\";\nimport { AllureCucumberWorld } from \"./legacy.js\";\nimport { AllureCucumberTestRuntime } from \"./runtime.js\";\nimport { getPosixPathRelativeToProjectRoot } from \"./utils.js\";\n\nBeforeAll(() => {\n  setGlobalTestRuntime(new AllureCucumberTestRuntime());\n});\n\nBefore({ name: \"ALLURE_FIXTURE_IGNORE\" }, (scenario) => {\n  const testPlan = parseTestPlan();\n  if (!testPlan) {\n    return;\n  }\n  const pickle = scenario.pickle;\n  const posixPath = getPosixPathRelativeToProjectRoot(pickle);\n\n  const fullName = `${posixPath}#${pickle.name}`;\n  const tags = pickle.tags.map((tag) => tag.name);\n\n  if (!includedInTestPlan(testPlan, { fullName, tags })) {\n    // we can't use regular message or Allure facade since we need label to be added\n    // to test, not fixture\n    world.attach(Buffer.from(\"allure-skip\"), \"application/vnd.allure.skipcucumber+json\");\n    return \"skipped\";\n  }\n});\n\nexport { AllureCucumberTestRuntime, AllureCucumberWorld };\n"],"mappings":";;;;;;;;;;;;;;;;;AAAA,IAAAA,SAAA,GAAAC,OAAA;AACA,IAAAC,SAAA,GAAAD,OAAA;AAEA,IAAAE,QAAA,GAAAF,OAAA;AACA,IAAAG,OAAA,GAAAH,OAAA;AACA,IAAAI,SAAA,GAAAJ,OAAA;AACA,IAAAK,MAAA,GAAAL,OAAA;AAEA,IAAAM,mBAAS,EAAC,MAAM;EACd,IAAAC,6BAAoB,EAAC,IAAIC,mCAAyB,CAAC,CAAC,CAAC;AACvD,CAAC,CAAC;AAEF,IAAAC,gBAAM,EAAC;EAAEC,IAAI,EAAE;AAAwB,CAAC,EAAGC,QAAQ,IAAK;EACtD,IAAMC,QAAQ,GAAG,IAAAC,uBAAa,EAAC,CAAC;EAChC,IAAI,CAACD,QAAQ,EAAE;IACb;EACF;EACA,IAAME,MAAM,GAAGH,QAAQ,CAACG,MAAM;EAC9B,IAAMC,SAAS,GAAG,IAAAC,wCAAiC,EAACF,MAAM,CAAC;EAE3D,IAAMG,QAAQ,MAAAC,MAAA,CAAMH,SAAS,OAAAG,MAAA,CAAIJ,MAAM,CAACJ,IAAI,CAAE;EAC9C,IAAMS,IAAI,GAAGL,MAAM,CAACK,IAAI,CAACC,GAAG,CAAEC,GAAG,IAAKA,GAAG,CAACX,IAAI,CAAC;EAE/C,IAAI,CAAC,IAAAY,4BAAkB,EAACV,QAAQ,EAAE;IAAEK,QAAQ;IAAEE;EAAK,CAAC,CAAC,EAAE;IACrD;IACA;IACAI,eAAK,CAACC,MAAM,CAACC,MAAM,CAACC,IAAI,CAAC,aAAa,CAAC,EAAE,0CAA0C,CAAC;IACpF,OAAO,SAAS;EAClB;AACF,CAAC,CAAC","ignoreList":[]}
{"version":3,"file":"index.js","names":["Before","BeforeAll","world","includedInTestPlan","parseTestPlan","setGlobalTestRuntime","AllureCucumberWorld","AllureCucumberTestRuntime","getPosixPathRelativeToProjectRoot","name","scenario","testPlan","pickle","posixPath","fullName","concat","tags","map","tag","attach","Buffer","from"],"sources":["../../src/index.ts"],"sourcesContent":["import { Before, BeforeAll, world } from \"@cucumber/cucumber\";\nimport { includedInTestPlan } from \"allure-js-commons/sdk/reporter\";\nimport { parseTestPlan } from \"allure-js-commons/sdk/reporter\";\nimport { setGlobalTestRuntime } from \"allure-js-commons/sdk/runtime\";\nimport { AllureCucumberWorld } from \"./legacy.js\";\nimport { AllureCucumberTestRuntime } from \"./runtime.js\";\nimport { getPosixPathRelativeToProjectRoot } from \"./utils.js\";\n\nBeforeAll(() => {\n  setGlobalTestRuntime(new AllureCucumberTestRuntime());\n});\n\nBefore({ name: \"ALLURE_FIXTURE_IGNORE\" }, (scenario) => {\n  const testPlan = parseTestPlan();\n  if (!testPlan) {\n    return;\n  }\n  const pickle = scenario.pickle;\n  const posixPath = getPosixPathRelativeToProjectRoot(pickle);\n\n  const fullName = `${posixPath}#${pickle.name}`;\n  const tags = pickle.tags.map((tag) => tag.name);\n\n  if (!includedInTestPlan(testPlan, { fullName, tags })) {\n    // we can't use regular message or Allure facade since we need label to be added\n    // to test, not fixture\n    world.attach(Buffer.from(\"allure-skip\"), \"application/vnd.allure.skipcucumber+json\");\n    return \"skipped\";\n  }\n});\n\nexport { AllureCucumberTestRuntime, AllureCucumberWorld };\n"],"mappings":"AAAA,SAASA,MAAM,EAAEC,SAAS,EAAEC,KAAK,QAAQ,oBAAoB;AAC7D,SAASC,kBAAkB,QAAQ,gCAAgC;AACnE,SAASC,aAAa,QAAQ,gCAAgC;AAC9D,SAASC,oBAAoB,QAAQ,+BAA+B;AACpE,SAASC,mBAAmB,QAAQ,aAAa;AACjD,SAASC,yBAAyB,QAAQ,cAAc;AACxD,SAASC,iCAAiC,QAAQ,YAAY;AAE9DP,SAAS,CAAC,MAAM;EACdI,oBAAoB,CAAC,IAAIE,yBAAyB,CAAC,CAAC,CAAC;AACvD,CAAC,CAAC;AAEFP,MAAM,CAAC;EAAES,IAAI,EAAE;AAAwB,CAAC,EAAGC,QAAQ,IAAK;EACtD,IAAMC,QAAQ,GAAGP,aAAa,CAAC,CAAC;EAChC,IAAI,CAACO,QAAQ,EAAE;IACb;EACF;EACA,IAAMC,MAAM,GAAGF,QAAQ,CAACE,MAAM;EAC9B,IAAMC,SAAS,GAAGL,iCAAiC,CAACI,MAAM,CAAC;EAE3D,IAAME,QAAQ,MAAAC,MAAA,CAAMF,SAAS,OAAAE,MAAA,CAAIH,MAAM,CAACH,IAAI,CAAE;EAC9C,IAAMO,IAAI,GAAGJ,MAAM,CAACI,IAAI,CAACC,GAAG,CAAEC,GAAG,IAAKA,GAAG,CAACT,IAAI,CAAC;EAE/C,IAAI,CAACN,kBAAkB,CAACQ,QAAQ,EAAE;IAAEG,QAAQ;IAAEE;EAAK,CAAC,CAAC,EAAE;IACrD;IACA;IACAd,KAAK,CAACiB,MAAM,CAACC,MAAM,CAACC,IAAI,CAAC,aAAa,CAAC,EAAE,0CAA0C,CAAC;IACpF,OAAO,SAAS;EAClB;AACF,CAAC,CAAC;AAEF,SAASd,yBAAyB,EAAED,mBAAmB","ignoreList":[]}